(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[423],{1482:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{v:function(){return BaseSolanaAdapter}});var _web3auth_base__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(45624),bs58__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(77191),bs58__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(bs58__WEBPACK_IMPORTED_MODULE_1__);class BaseSolanaAdapter extends _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.J5{async authenticateUser(){var _this$chainConfig;if(!this.provider||!(null!==(_this$chainConfig=this.chainConfig)&&void 0!==_this$chainConfig&&_this$chainConfig.chainId))throw _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.RM.notConnectedError();let{chainNamespace,chainId}=this.chainConfig;if(this.status!==_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.MP.CONNECTED)throw _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.RM.notConnectedError("Not connected with wallet, Please login/connect first");let accounts=await this.provider.request({method:"getAccounts"});if(accounts&&accounts.length>0){let existingToken=(0,_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.Cb)(accounts[0],this.name);if(existingToken){let isExpired=(0,_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.$E)(existingToken);if(!isExpired)return{idToken:existingToken}}let payload={domain:window.location.origin,uri:window.location.href,address:accounts[0],chainId:parseInt(chainId,16),version:"1",nonce:Math.random().toString(36).slice(2),issuedAt:new Date().toISOString()},challenge=await (0,_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.tV)(payload,chainNamespace),encodedMessage=new TextEncoder().encode(challenge),signedMessage=await this.provider.request({method:"signMessage",params:{message:encodedMessage,display:"utf8"}}),idToken=await (0,_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.rn)(chainNamespace,bs58__WEBPACK_IMPORTED_MODULE_1___default().encode(signedMessage),challenge,this.name,this.sessionTime);return(0,_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.Fr)(accounts[0],this.name,idToken),{idToken}}throw _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.RM.notConnectedError("Not connected with wallet, Please login/connect first")}async disconnect(){if(this.status!==_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.MP.CONNECTED)throw _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.RM.disconnectionError("Not connected with wallet");let accounts=await this.provider.request({method:"getAccounts"});accounts&&accounts.length>0&&(0,_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.qz)(accounts[0],this.name)}}},94423:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{SolanaWalletAdapter:function(){return SolanaWalletAdapter}});var defineProperty=__webpack_require__(4942),index_browser_esm=__webpack_require__(59917),baseControllers_esm=__webpack_require__(22782),httpHelpers_esm=__webpack_require__(20917),openloginJrpc_esm=__webpack_require__(95844),dist=__webpack_require__(79826),is_stream=__webpack_require__(24970),pump=__webpack_require__(74286),pump_default=__webpack_require__.n(pump),loglevel=__webpack_require__(2043),loglevel_default=__webpack_require__.n(loglevel),fast_deep_equal=__webpack_require__(64063),fast_deep_equal_default=__webpack_require__.n(fast_deep_equal),Buffer=__webpack_require__(48764).Buffer,messages={errors:{disconnected:()=>"Torus: Lost connection to Torus.",permanentlyDisconnected:()=>"Torus: Disconnected from iframe. Page reload required.",unsupportedSync:method=>"Torus: The Torus Ethereum provider does not support synchronous methods like ".concat(method," without a callback parameter."),invalidDuplexStream:()=>"Must provide a Node.js-style duplex stream.",invalidOptions:maxEventListeners=>"Invalid options. Received: { maxEventListeners: ".concat(maxEventListeners,"}"),invalidRequestArgs:()=>"Expected a single, non-array, object argument.",invalidRequestMethod:()=>"'args.method' must be a non-empty string.",invalidRequestParams:()=>"'args.params' must be an object or array if provided.",invalidLoggerObject:()=>"'args.logger' must be an object if provided.",invalidLoggerMethod:method=>"'args.logger' must include required method '".concat(method,"'.")},info:{connected:chainId=>'Torus: Connected to chain with ID "'.concat(chainId,'".')},warnings:{}};let TORUS_BUILD_ENV={PRODUCTION:"production",DEVELOPMENT:"development",TESTING:"testing"},BUTTON_POSITION={BOTTOM_LEFT:"bottom-left",TOP_LEFT:"top-left",BOTTOM_RIGHT:"bottom-right",TOP_RIGHT:"top-right"},LOGIN_PROVIDER={GOOGLE:"google",FACEBOOK:"facebook",REDDIT:"reddit",DISCORD:"discord",TWITCH:"twitch",APPLE:"apple",LINE:"line",GITHUB:"github",KAKAO:"kakao",LINKEDIN:"linkedin",TWITTER:"twitter",WEIBO:"weibo",WECHAT:"wechat",EMAIL_PASSWORDLESS:"email_passwordless"};var configuration={supportedVerifierList:[LOGIN_PROVIDER.GOOGLE,LOGIN_PROVIDER.REDDIT,LOGIN_PROVIDER.DISCORD],api:"https://api.tor.us",translations:{en:{embed:{continue:"Continue",actionRequired:"Authorization required",pendingAction:"Click continue to proceed with your request in a popup",cookiesRequired:"Cookies Required",enableCookies:"Please enable cookies in your browser preferences to access Torus",clickHere:"More Info"}},de:{embed:{continue:"Fortsetzen",actionRequired:"Autorisierung erforderlich",pendingAction:"Klicken Sie in einem Popup auf Weiter, um mit Ihrer Anfrage fortzufahren",cookiesRequired:"Cookies ben\xf6tigt",enableCookies:"Bitte aktivieren Sie Cookies in Ihren Browsereinstellungen, um auf Torus zuzugreifen",clickHere:"Mehr Info"}},ja:{embed:{continue:"継続する",actionRequired:"認証が必要です",pendingAction:"続行をクリックして、ポップアップでリクエストを続行します",cookiesRequired:"必要なクッキー",enableCookies:"Torusにアクセスするには、ブラウザの設定でCookieを有効にしてください。",clickHere:"詳しくは"}},ko:{embed:{continue:"계속하다",actionRequired:"승인 필요",pendingAction:"팝업에서 요청을 진행하려면 계속을 클릭하십시오.",cookiesRequired:"쿠키 필요",enableCookies:"브라우저 환경 설정에서 쿠키를 활성화하여 Torus에 액세스하십시오.",clickHere:"더 많은 정보"}},zh:{embed:{continue:"继续",actionRequired:"需要授权",pendingAction:"单击继续以在弹出窗口中继续您的请求",cookiesRequired:"必填Cookie",enableCookies:"请在您的浏览器首选项中启用cookie以访问Torus。",clickHere:"更多信息"}}},prodTorusUrl:"",localStorageKey:"torus-".concat(window.location.hostname)},log=loglevel_default().getLogger("solana-embed");let getWindowId=()=>Math.random().toString(36).slice(2),getTorusUrl=async buildEnv=>{let torusUrl,logLevel;switch(buildEnv){case"testing":torusUrl="https://solana-testing.tor.us",logLevel="debug";break;case"development":torusUrl="http://localhost:8080",logLevel="debug";break;default:torusUrl="https://solana.tor.us",logLevel="error"}return{torusUrl,logLevel}},getUserLanguage=()=>{let userLanguage=window.navigator.language||"en-US",userLanguages=userLanguage.split("-");return Object.prototype.hasOwnProperty.call(configuration.translations,userLanguages[0])?userLanguages[0]:"en"},FEATURES_PROVIDER_CHANGE_WINDOW={height:660,width:375},FEATURES_DEFAULT_WALLET_WINDOW={height:740,width:1315},FEATURES_DEFAULT_POPUP_WINDOW={height:700,width:1200},FEATURES_CONFIRM_WINDOW={height:600,width:400};function getPopupFeatures(_ref){let{width:w,height:h}=_ref,dualScreenLeft=void 0!==window.screenLeft?window.screenLeft:window.screenX,dualScreenTop=void 0!==window.screenTop?window.screenTop:window.screenY,width=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:window.screen.width,height=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:window.screen.height,features="titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=".concat(h/1,",width=").concat(w/1,",top=").concat(Math.abs((height-h)/2/1+dualScreenTop),",left=").concat(Math.abs((width-w)/2/1+dualScreenLeft));return features}class BaseProvider extends openloginJrpc_esm.Ue{constructor(connectionStream,_ref){let{maxEventListeners=100,jsonRpcStreamName="provider"}=_ref;if(super(),(0,defineProperty.Z)(this,"isTorus",void 0),(0,defineProperty.Z)(this,"_rpcEngine",void 0),(0,defineProperty.Z)(this,"jsonRpcConnectionEvents",void 0),(0,defineProperty.Z)(this,"_state",void 0),!(0,is_stream.duplex)(connectionStream))throw Error(messages.errors.invalidDuplexStream());this.isTorus=!0,this.setMaxListeners(maxEventListeners),this._handleConnect=this._handleConnect.bind(this),this._handleDisconnect=this._handleDisconnect.bind(this),this._handleStreamDisconnect=this._handleStreamDisconnect.bind(this),this._rpcRequest=this._rpcRequest.bind(this),this._initializeState=this._initializeState.bind(this),this.request=this.request.bind(this),this.sendAsync=this.sendAsync.bind(this);let mux=new openloginJrpc_esm.O4;pump_default()(connectionStream,mux,connectionStream,this._handleStreamDisconnect.bind(this,"Torus")),mux.ignoreStream("phishing");let jsonRpcConnection=(0,openloginJrpc_esm.AP)();pump_default()(jsonRpcConnection.stream,mux.createStream(jsonRpcStreamName),jsonRpcConnection.stream,this._handleStreamDisconnect.bind(this,"Torus RpcProvider"));let rpcEngine=new openloginJrpc_esm.eI;rpcEngine.push((0,openloginJrpc_esm.Rq)()),rpcEngine.push((req,res,next)=>{"string"==typeof req.method&&req.method||(res.error=dist.ethErrors.rpc.invalidRequest({message:"The request 'method' must be a non-empty string.",data:req})),next(done=>{let{error}=res;return error&&log.error("Torus - RPC Error: ".concat(error.message),error),done()})}),rpcEngine.push((0,baseControllers_esm.yh)({origin:location.origin})),rpcEngine.push(jsonRpcConnection.middleware),this._rpcEngine=rpcEngine,this.jsonRpcConnectionEvents=jsonRpcConnection.events}async request(args){if(!args||"object"!=typeof args||Array.isArray(args))throw dist.ethErrors.rpc.invalidRequest({message:messages.errors.invalidRequestArgs(),data:args});let{method,params}=args;if("string"!=typeof method||0===method.length)throw dist.ethErrors.rpc.invalidRequest({message:messages.errors.invalidRequestMethod(),data:args});if(void 0!==params&&!Array.isArray(params)&&("object"!=typeof params||null===params))throw dist.ethErrors.rpc.invalidRequest({message:messages.errors.invalidRequestParams(),data:args});return new Promise((resolve,reject)=>{this._rpcRequest({method,params},(0,openloginJrpc_esm.nE)(resolve,reject))})}send(payload,callback){this._rpcRequest(payload,callback)}sendAsync(payload){return new Promise((resolve,reject)=>{this._rpcRequest(payload,(0,openloginJrpc_esm.nE)(resolve,reject))})}_handleStreamDisconnect(streamName,error){let warningMsg;warningMsg='Torus: Lost connection to "'.concat(streamName,'".'),null!=error&&error.stack&&(warningMsg+="\n".concat(error.stack)),log.warn(warningMsg),this&&this.listenerCount("error")>0&&this.emit("error",warningMsg),this._handleDisconnect(!1,error?error.message:void 0)}}let handleEvent=function(handle,eventName,handler){for(var _len=arguments.length,handlerArgs=Array(_len>3?_len-3:0),_key=3;_key<_len;_key++)handlerArgs[_key-3]=arguments[_key];let handlerWrapper=()=>{handler(...handlerArgs),handle.removeEventListener(eventName,handlerWrapper)};handle.addEventListener(eventName,handlerWrapper)};async function documentReady(){return new Promise(resolve=>{"loading"!==document.readyState?resolve():handleEvent(document,"DOMContentLoaded",resolve)})}let htmlToElement=html=>{let template=window.document.createElement("template"),trimmedHtml=html.trim();return template.innerHTML=trimmedHtml,template.content.firstChild};class PopupHandler extends openloginJrpc_esm.Ue{constructor(_ref){let{url,target,features}=_ref;super(),(0,defineProperty.Z)(this,"url",void 0),(0,defineProperty.Z)(this,"target",void 0),(0,defineProperty.Z)(this,"features",void 0),(0,defineProperty.Z)(this,"window",void 0),(0,defineProperty.Z)(this,"windowTimer",void 0),(0,defineProperty.Z)(this,"iClosedWindow",void 0),this.url=url,this.target=target||"_blank",this.features=features||getPopupFeatures(FEATURES_DEFAULT_POPUP_WINDOW),this.window=void 0,this.windowTimer=void 0,this.iClosedWindow=!1,this._setupTimer()}_setupTimer(){this.windowTimer=Number(setInterval(()=>{this.window&&this.window.closed&&(clearInterval(this.windowTimer),this.iClosedWindow||this.emit("close"),this.iClosedWindow=!1,this.window=void 0),void 0===this.window&&clearInterval(this.windowTimer)},500))}open(){var _this$window;return this.window=window.open(this.url.href,this.target,this.features),null!==(_this$window=this.window)&&void 0!==_this$window&&_this$window.focus&&this.window.focus(),Promise.resolve()}close(){this.iClosedWindow=!0,this.window&&this.window.close()}redirect(locationReplaceOnRedirect){locationReplaceOnRedirect?window.location.replace(this.url.href):window.location.href=this.url.href}}function ownKeys$2(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}class TorusCommunicationProvider extends BaseProvider{constructor(connectionStream,_ref){let{maxEventListeners=100,jsonRpcStreamName="provider"}=_ref;super(connectionStream,{maxEventListeners,jsonRpcStreamName}),(0,defineProperty.Z)(this,"embedTranslations",void 0),(0,defineProperty.Z)(this,"torusUrl",void 0),(0,defineProperty.Z)(this,"dappStorageKey",void 0),(0,defineProperty.Z)(this,"windowRefs",void 0),(0,defineProperty.Z)(this,"tryWindowHandle",void 0),(0,defineProperty.Z)(this,"torusAlertContainer",void 0),(0,defineProperty.Z)(this,"torusIframe",void 0),this._state=function(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys$2(Object(source),!0).forEach(function(key){(0,defineProperty.Z)(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys$2(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}({},TorusCommunicationProvider._defaultState),this.torusUrl="",this.dappStorageKey="";let languageTranslations=configuration.translations[getUserLanguage()];this.embedTranslations=languageTranslations.embed,this.windowRefs={},this.on("connect",()=>{this._state.isConnected=!0});let notificationHandler=payload=>{let{method,params}=payload;if(method===baseControllers_esm.Nb.IFRAME_STATUS){let{isFullScreen,rid}=params;this._displayIframe({isFull:isFullScreen,rid:rid})}else if(method===baseControllers_esm.Nb.CREATE_WINDOW){let{windowId,url}=params;this._createPopupBlockAlert(windowId,url)}else if(method===baseControllers_esm.Nb.CLOSE_WINDOW)this._handleCloseWindow(params);else if(method===baseControllers_esm.Nb.USER_LOGGED_IN){let{currentLoginProvider}=params;this._state.isLoggedIn=!0,this._state.currentLoginProvider=currentLoginProvider}else method===baseControllers_esm.Nb.USER_LOGGED_OUT&&(this._state.isLoggedIn=!1,this._state.currentLoginProvider=null,this._displayIframe())};this.jsonRpcConnectionEvents.on("notification",notificationHandler)}get isLoggedIn(){return this._state.isLoggedIn}get isIFrameFullScreen(){return this._state.isIFrameFullScreen}isConnected(){return this._state.isConnected}async _initializeState(params){try{let{torusUrl,dappStorageKey,torusAlertContainer,torusIframe}=params;this.torusUrl=torusUrl,this.dappStorageKey=dappStorageKey,this.torusAlertContainer=torusAlertContainer,this.torusIframe=torusIframe,this.torusIframe.addEventListener("load",()=>{this._state.isIFrameFullScreen||this._displayIframe()});let{currentLoginProvider,isLoggedIn}=await this.request({method:baseControllers_esm.vU.GET_PROVIDER_STATE,params:[]});this._handleConnect(currentLoginProvider,isLoggedIn)}catch(error){log.error("Torus: Failed to get initial state. Please report this bug.",error)}finally{log.info("initialized communication state"),this._state.initialized=!0,this.emit("_initialized")}}_handleWindow(windowId){let{url,target,features}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},finalUrl=new URL(url||"".concat(this.torusUrl,"/redirect?windowId=").concat(windowId));this.dappStorageKey&&(finalUrl.hash?finalUrl.hash+="&dappStorageKey=".concat(this.dappStorageKey):finalUrl.hash="#dappStorageKey=".concat(this.dappStorageKey));let handledWindow=new PopupHandler({url:finalUrl,target,features});if(handledWindow.open(),!handledWindow.window){this._createPopupBlockAlert(windowId,finalUrl.href);return}this.windowRefs[windowId]=handledWindow,this.request({method:baseControllers_esm.vU.OPENED_WINDOW,params:{windowId}}),handledWindow.once("close",()=>{delete this.windowRefs[windowId],this.request({method:baseControllers_esm.vU.CLOSED_WINDOW,params:{windowId}})})}_displayIframe(){let{isFull=!1,rid=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},style={};if(isFull)style.display="block",style.width="100%",style.height="100%",style.top="0px",style.right="0px",style.left="0px",style.bottom="0px";else switch(style.display=this._state.torusWidgetVisibility?"block":"none",style.height="70px",style.width="70px",this._state.buttonPosition){case BUTTON_POSITION.TOP_LEFT:style.top="0px",style.left="0px",style.right="auto",style.bottom="auto";break;case BUTTON_POSITION.TOP_RIGHT:style.top="0px",style.right="0px",style.left="auto",style.bottom="auto";break;case BUTTON_POSITION.BOTTOM_RIGHT:style.bottom="0px",style.right="0px",style.top="auto",style.left="auto";break;case BUTTON_POSITION.BOTTOM_LEFT:default:style.bottom="0px",style.left="0px",style.top="auto",style.right="auto"}Object.assign(this.torusIframe.style,style),this._state.isIFrameFullScreen=isFull,this.request({method:baseControllers_esm.vU.IFRAME_STATUS,params:{isIFrameFullScreen:isFull,rid}})}hideTorusButton(){this._state.torusWidgetVisibility=!1,this._displayIframe()}showTorusButton(){this._state.torusWidgetVisibility=!0,this._displayIframe()}_rpcRequest(payload,callback){let _payload=payload;Array.isArray(_payload)||_payload.jsonrpc||(_payload.jsonrpc="2.0"),this.tryWindowHandle(_payload,callback)}_handleConnect(currentLoginProvider,isLoggedIn){this._state.isConnected||(this._state.isConnected=!0,this.emit("connect",{currentLoginProvider,isLoggedIn}),log.debug(messages.info.connected(currentLoginProvider)))}_handleDisconnect(isRecoverable,errorMessage){if(this._state.isConnected||!this._state.isPermanentlyDisconnected&&!isRecoverable){let error;this._state.isConnected=!1,isRecoverable?(error=new dist.EthereumRpcError(1013,errorMessage||messages.errors.disconnected()),log.debug(error)):(error=new dist.EthereumRpcError(1011,errorMessage||messages.errors.permanentlyDisconnected()),log.error(error),this._state.currentLoginProvider=null,this._state.isLoggedIn=!1,this._state.torusWidgetVisibility=!1,this._state.isIFrameFullScreen=!1,this._state.isPermanentlyDisconnected=!0),this.emit("disconnect",error)}}_handleCloseWindow(params){let{windowId}=params;this.windowRefs[windowId]&&(this.windowRefs[windowId].close(),delete this.windowRefs[windowId])}async _createPopupBlockAlert(windowId,url){let logoUrl=this.getLogoUrl(),torusAlert=htmlToElement('<div id="torusAlert" class="torus-alert--v2">'+'<div id="torusAlert__logo"><img src="'.concat(logoUrl,'" /></div>')+"<div>"+'<h1 id="torusAlert__title">'.concat(this.embedTranslations.actionRequired,"</h1>")+'<p id="torusAlert__desc">'.concat(this.embedTranslations.pendingAction,"</p>")+"</div></div>"),successAlert=htmlToElement('<div><a id="torusAlert__btn">'.concat(this.embedTranslations.continue,"</a></div>")),btnContainer=htmlToElement('<div id="torusAlert__btn-container"></div>');btnContainer.appendChild(successAlert),torusAlert.appendChild(btnContainer),await documentReady(),(()=>{this.torusAlertContainer.appendChild(torusAlert)})(),(()=>{successAlert.addEventListener("click",()=>{this._handleWindow(windowId,{url,target:"_blank",features:getPopupFeatures(FEATURES_CONFIRM_WINDOW)}),torusAlert.remove(),0===this.torusAlertContainer.children.length&&(this.torusAlertContainer.style.display="none")})})(),this.torusAlertContainer.style.display="block"}getLogoUrl(){let logoUrl="".concat(this.torusUrl,"/images/torus_icon-blue.svg");return logoUrl}}function ownKeys$1(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}(0,defineProperty.Z)(TorusCommunicationProvider,"_defaultState",{buttonPosition:"bottom-left",currentLoginProvider:null,isIFrameFullScreen:!1,hasEmittedConnection:!1,torusWidgetVisibility:!1,initialized:!1,isLoggedIn:!1,isPermanentlyDisconnected:!1,isConnected:!1});class TorusInPageProvider extends BaseProvider{constructor(connectionStream,_ref){let{maxEventListeners=100,jsonRpcStreamName="provider"}=_ref;super(connectionStream,{maxEventListeners,jsonRpcStreamName}),(0,defineProperty.Z)(this,"chainId",void 0),(0,defineProperty.Z)(this,"selectedAddress",void 0),(0,defineProperty.Z)(this,"tryWindowHandle",void 0),this._state=function(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys$1(Object(source),!0).forEach(function(key){(0,defineProperty.Z)(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys$1(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}({},TorusInPageProvider._defaultState),this.selectedAddress=null,this.chainId=null,this._handleAccountsChanged=this._handleAccountsChanged.bind(this),this._handleChainChanged=this._handleChainChanged.bind(this),this._handleUnlockStateChanged=this._handleUnlockStateChanged.bind(this),this.on("connect",()=>{this._state.isConnected=!0});let jsonRpcNotificationHandler=payload=>{let{method,params}=payload;method===baseControllers_esm.zK.ACCOUNTS_CHANGED?this._handleAccountsChanged(params):method===baseControllers_esm.zK.UNLOCK_STATE_CHANGED?this._handleUnlockStateChanged(params):method===baseControllers_esm.zK.CHAIN_CHANGED&&this._handleChainChanged(params)};this.jsonRpcConnectionEvents.on("notification",jsonRpcNotificationHandler)}isConnected(){return this._state.isConnected}async _initializeState(){try{let{accounts,chainId,isUnlocked}=await this.request({method:baseControllers_esm.GA.GET_PROVIDER_STATE,params:[]});this.emit("connect",{chainId}),this._handleChainChanged({chainId}),this._handleUnlockStateChanged({accounts,isUnlocked}),this._handleAccountsChanged(accounts)}catch(error){log.error("Torus: Failed to get initial state. Please report this bug.",error)}finally{log.info("initialized provider state"),this._state.initialized=!0,this.emit("_initialized")}}_rpcRequest(payload,callback){let isInternal=arguments.length>2&&void 0!==arguments[2]&&arguments[2],cb=callback,_payload=payload;if(!Array.isArray(_payload)){if(_payload.jsonrpc||(_payload.jsonrpc="2.0"),"solana_accounts"===_payload.method||"solana_requestAccounts"===_payload.method)cb=(err,res)=>{this._handleAccountsChanged(res.result||[],"solana_accounts"===_payload.method,isInternal),callback(err,res)};else if("wallet_getProviderState"===_payload.method){this._rpcEngine.handle(payload,cb);return}}this.tryWindowHandle(_payload,cb)}_handleConnect(chainId){this._state.isConnected||(this._state.isConnected=!0,this.emit("connect",{chainId}),log.debug(messages.info.connected(chainId)))}_handleDisconnect(isRecoverable,errorMessage){if(this._state.isConnected||!this._state.isPermanentlyDisconnected&&!isRecoverable){let error;this._state.isConnected=!1,isRecoverable?(error=new dist.EthereumRpcError(1013,errorMessage||messages.errors.disconnected()),log.debug(error)):(error=new dist.EthereumRpcError(1011,errorMessage||messages.errors.permanentlyDisconnected()),log.error(error),this.chainId=null,this._state.accounts=null,this.selectedAddress=null,this._state.isUnlocked=!1,this._state.isPermanentlyDisconnected=!0),this.emit("disconnect",error)}}_handleAccountsChanged(accounts){let isEthAccounts=arguments.length>1&&void 0!==arguments[1]&&arguments[1],isInternal=arguments.length>2&&void 0!==arguments[2]&&arguments[2],finalAccounts=accounts;for(let account of(Array.isArray(finalAccounts)||(log.error("Torus: Received non-array accounts parameter. Please report this bug.",finalAccounts),finalAccounts=[]),accounts))if("string"!=typeof account){log.error("Torus: Received non-string account. Please report this bug.",accounts),finalAccounts=[];break}fast_deep_equal_default()(this._state.accounts,finalAccounts)||(isEthAccounts&&Array.isArray(this._state.accounts)&&this._state.accounts.length>0&&!isInternal&&log.error('Torus: "solana_accounts" unexpectedly updated accounts. Please report this bug.',finalAccounts),this._state.accounts=finalAccounts,this.emit("accountsChanged",finalAccounts)),this.selectedAddress!==finalAccounts[0]&&(this.selectedAddress=finalAccounts[0]||null)}_handleChainChanged(){let{chainId}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!chainId){log.error("Torus: Received invalid network parameters. Please report this bug.",{chainId});return}"loading"===chainId?this._handleDisconnect(!0):(this._handleConnect(chainId),chainId!==this.chainId&&(this.chainId=chainId,this._state.initialized&&this.emit("chainChanged",this.chainId)))}_handleUnlockStateChanged(){let{accounts,isUnlocked}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("boolean"!=typeof isUnlocked){log.error("Torus: Received invalid isUnlocked parameter. Please report this bug.",{isUnlocked});return}isUnlocked!==this._state.isUnlocked&&(this._state.isUnlocked=isUnlocked,this._handleAccountsChanged(accounts||[]))}}function imgExists(url){return new Promise((resolve,reject)=>{try{let img=document.createElement("img");img.onload=()=>resolve(!0),img.onerror=()=>resolve(!1),img.src=url}catch(e){reject(e)}})}(0,defineProperty.Z)(TorusInPageProvider,"_defaultState",{accounts:null,isConnected:!1,isUnlocked:!1,initialized:!1,isPermanentlyDisconnected:!1,hasEmittedConnection:!1});let getSiteName=window1=>{let{document:document1}=window1,siteName=document1.querySelector('head > meta[property="og:site_name"]');if(siteName)return siteName.content;let metaTitle=document1.querySelector('head > meta[name="title"]');return metaTitle?metaTitle.content:document1.title&&document1.title.length>0?document1.title:window1.location.hostname};async function getSiteIcon(window1){try{let{document:document1}=window1,icon=document1.querySelector('head > link[rel="shortcut icon"]');if(icon&&await imgExists(icon.href)||(icon=Array.from(document1.querySelectorAll('head > link[rel="icon"]')).find(_icon=>Boolean(_icon.href)))&&await imgExists(icon.href))return icon.href;return""}catch(error){return""}}let getSiteMetadata=async()=>({name:getSiteName(window),icon:await getSiteIcon(window)});function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){(0,defineProperty.Z)(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}let{version}=__webpack_require__(27384),PROVIDER_UNSAFE_METHODS=["send_transaction","sign_transaction","sign_all_transactions","sign_message","connect"],COMMUNICATION_UNSAFE_METHODS=[baseControllers_esm.vU.SET_PROVIDER],isLocalStorageAvailable=function(type){let storage;try{storage=window[type];let x="__storage_test__";return storage.setItem(x,x),storage.removeItem(x),!0}catch(e){return e&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&storage&&0!==storage.length}}("localStorage");!async function(){try{if("undefined"==typeof document)return;let torusIframeHtml=document.createElement("link"),{torusUrl}=await getTorusUrl("production");torusIframeHtml.href="".concat(torusUrl,"/frame"),torusIframeHtml.crossOrigin="anonymous",torusIframeHtml.type="text/html",torusIframeHtml.rel="prefetch",torusIframeHtml.relList&&torusIframeHtml.relList.supports&&torusIframeHtml.relList.supports("prefetch")&&document.head.appendChild(torusIframeHtml)}catch(error){log.warn(error)}}();class Torus{constructor(){let{modalZIndex=99999}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,defineProperty.Z)(this,"isInitialized",void 0),(0,defineProperty.Z)(this,"torusAlert",void 0),(0,defineProperty.Z)(this,"modalZIndex",void 0),(0,defineProperty.Z)(this,"alertZIndex",void 0),(0,defineProperty.Z)(this,"requestedLoginProvider",void 0),(0,defineProperty.Z)(this,"provider",void 0),(0,defineProperty.Z)(this,"communicationProvider",void 0),(0,defineProperty.Z)(this,"dappStorageKey",void 0),(0,defineProperty.Z)(this,"torusAlertContainer",void 0),(0,defineProperty.Z)(this,"torusUrl",void 0),(0,defineProperty.Z)(this,"torusIframe",void 0),(0,defineProperty.Z)(this,"styleLink",void 0),this.torusUrl="",this.isInitialized=!1,this.requestedLoginProvider=null,this.modalZIndex=modalZIndex,this.alertZIndex=modalZIndex+1e3,this.dappStorageKey=""}get isLoggedIn(){return!!this.communicationProvider&&this.communicationProvider.isLoggedIn}async init(){let{buildEnv=TORUS_BUILD_ENV.PRODUCTION,enableLogging=!1,network,showTorusButton=!1,useLocalStorage=!1,buttonPosition=BUTTON_POSITION.BOTTOM_LEFT,apiKey="torus-default",extraParams={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.isInitialized)throw Error("Already initialized");(0,httpHelpers_esm.ut)(apiKey);let{torusUrl,logLevel}=await getTorusUrl(buildEnv);log.enableAll(),log.info(torusUrl,"url loaded"),log.info("Solana Embed Version :".concat(version)),this.torusUrl=torusUrl,log.setDefaultLevel(logLevel),enableLogging?log.enableAll():log.disableAll();let dappStorageKey=this.handleDappStorageKey(useLocalStorage),torusIframeUrl=new URL(torusUrl);torusIframeUrl.pathname.endsWith("/")?torusIframeUrl.pathname+="frame":torusIframeUrl.pathname+="/frame";let hashParams=new URLSearchParams;dappStorageKey&&hashParams.append("dappStorageKey",dappStorageKey),hashParams.append("origin",window.location.origin),torusIframeUrl.hash=hashParams.toString(),this.torusIframe=htmlToElement('<iframe\n        id="torusIframe"\n        class="torusIframe"\n        src="'.concat(torusIframeUrl.href,'"\n        style="display: none; position: fixed; top: 0; right: 0; width: 100%;\n        height: 100%; border: none; border-radius: 0; z-index: ').concat(this.modalZIndex.toString(),'"\n      ></iframe>')),this.torusAlertContainer=htmlToElement('<div id="torusAlertContainer" style="display:none; z-index: '.concat(this.alertZIndex.toString(),'"></div>')),this.styleLink=htmlToElement('<link href="'.concat(torusUrl,'/css/widget.css" rel="stylesheet" type="text/css">'));let handleSetup=async()=>new Promise((resolve,reject)=>{try{window.document.head.appendChild(this.styleLink),window.document.body.appendChild(this.torusIframe),window.document.body.appendChild(this.torusAlertContainer),this.torusIframe.addEventListener("load",async()=>{let dappMetadata=await getSiteMetadata();this.torusIframe.contentWindow.postMessage({buttonPosition,apiKey,network,dappMetadata,extraParams},torusIframeUrl.origin),await this._setupWeb3({torusUrl}),showTorusButton?this.showTorusButton():this.hideTorusButton(),this.isInitialized=!0,window.torus=this,resolve()})}catch(error){reject(error)}});await documentReady(),await handleSetup()}async login(){let params=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.isInitialized)throw Error("Call init() first");try{this.requestedLoginProvider=params.loginProvider||null,this.requestedLoginProvider||this.communicationProvider._displayIframe({isFull:!0});let res=await new Promise((resolve,reject)=>{this.provider._rpcRequest({method:"solana_requestAccounts",params:[this.requestedLoginProvider,params.login_hint]},(0,openloginJrpc_esm.nE)(resolve,reject))});if(Array.isArray(res)&&res.length>0)return res;throw Error("Login failed")}catch(error){throw log.error("login failed",error),error}finally{this.communicationProvider.isIFrameFullScreen&&this.communicationProvider._displayIframe()}}async loginWithPrivateKey(loginParams){if(!this.isInitialized)throw Error("Call init() first");let{privateKey,userInfo}=loginParams,{success}=await this.communicationProvider.request({method:"login_with_private_key",params:{privateKey,userInfo}});if(!success)throw Error("Login Failed")}async logout(){if(!this.communicationProvider.isLoggedIn)throw Error("Not logged in");await this.communicationProvider.request({method:baseControllers_esm.vU.LOGOUT,params:[]}),this.requestedLoginProvider=null}async cleanUp(){this.communicationProvider.isLoggedIn&&await this.logout(),this.clearInit()}clearInit(){function isElement(element){return element instanceof Element||element instanceof Document}isElement(this.styleLink)&&window.document.body.contains(this.styleLink)&&(this.styleLink.remove(),this.styleLink=void 0),isElement(this.torusIframe)&&window.document.body.contains(this.torusIframe)&&(this.torusIframe.remove(),this.torusIframe=void 0),isElement(this.torusAlertContainer)&&window.document.body.contains(this.torusAlertContainer)&&(this.torusAlert=void 0,this.torusAlertContainer.remove(),this.torusAlertContainer=void 0),this.isInitialized=!1}hideTorusButton(){this.communicationProvider.hideTorusButton()}showTorusButton(){this.communicationProvider.showTorusButton()}async setProvider(params){await this.communicationProvider.request({method:baseControllers_esm.vU.SET_PROVIDER,params:_objectSpread({},params)})}async showWallet(path){let params=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},instanceId=await this.communicationProvider.request({method:baseControllers_esm.vU.WALLET_INSTANCE_ID,params:[]}),finalUrl=new URL("".concat(this.torusUrl,"/wallet").concat(path?"/".concat(path):""));finalUrl.searchParams.append("instanceId",instanceId),Object.keys(params).forEach(x=>{finalUrl.searchParams.append(x,params[x])}),this.dappStorageKey&&(finalUrl.hash="#dappStorageKey=".concat(this.dappStorageKey));let walletWindow=new PopupHandler({url:finalUrl,features:getPopupFeatures(FEATURES_DEFAULT_WALLET_WINDOW)});walletWindow.open()}async getUserInfo(){let userInfoResponse=await this.communicationProvider.request({method:baseControllers_esm.vU.USER_INFO,params:[]});return userInfoResponse}async initiateTopup(provider,params){if(!this.isInitialized)throw Error("Torus is not initialized");let windowId=getWindowId();this.communicationProvider._handleWindow(windowId);let topupResponse=await this.communicationProvider.request({method:baseControllers_esm.vU.TOPUP,params:{provider,params,windowId}});return topupResponse}async getAccounts(){let response=await this.provider.request({method:"getAccounts",params:[]});return response}async sendTransaction(transaction){let response=await this.provider.request({method:"send_transaction",params:{message:transaction.serialize({requireAllSignatures:!1}).toString("hex")}});return response}async signTransaction(transaction){let response=await this.provider.request({method:"sign_transaction",params:{message:transaction.serializeMessage().toString("hex"),messageOnly:!0}}),parsed=JSON.parse(response),signature={publicKey:new index_browser_esm.nh(parsed.publicKey),signature:Buffer.from(parsed.signature,"hex")};return transaction.addSignature(signature.publicKey,signature.signature),transaction}async signAllTransactions(transactions){let encodedMessage=transactions.map(tx=>tx.serializeMessage().toString("hex")),responses=await this.provider.request({method:"sign_all_transactions",params:{message:encodedMessage,messageOnly:!0}}),signatures=responses.map(item=>{let parsed=JSON.parse(item);return{publicKey:new index_browser_esm.nh(parsed.publicKey),signature:Buffer.from(parsed.signature,"hex")}});return transactions.forEach((tx,idx)=>(tx.addSignature(signatures[idx].publicKey,signatures[idx].signature),tx)),transactions}async signMessage(data){let response=await this.provider.request({method:"sign_message",params:{data}});return response}async getGaslessPublicKey(){let response=await this.provider.request({method:"get_gasless_public_key",params:[]});return response}handleDappStorageKey(useLocalStorage){let dappStorageKey="";if(isLocalStorageAvailable&&useLocalStorage){let storedKey=window.localStorage.getItem(configuration.localStorageKey);if(storedKey)dappStorageKey=storedKey;else{let generatedKey="torus-app-".concat(getWindowId());window.localStorage.setItem(configuration.localStorageKey,generatedKey),dappStorageKey=generatedKey}}return this.dappStorageKey=dappStorageKey,dappStorageKey}async _setupWeb3(providerParams){log.info("setupWeb3 running");let providerStream=new openloginJrpc_esm.XR({name:"embed_torus",target:"iframe_torus",targetWindow:this.torusIframe.contentWindow}),communicationStream=new openloginJrpc_esm.XR({name:"embed_communication",target:"iframe_communication",targetWindow:this.torusIframe.contentWindow}),inPageProvider=new TorusInPageProvider(providerStream,{}),communicationProvider=new TorusCommunicationProvider(communicationStream,{});inPageProvider.tryWindowHandle=(payload,cb)=>{let _payload=payload;if(!Array.isArray(_payload)&&PROVIDER_UNSAFE_METHODS.includes(_payload.method)){if(!this.communicationProvider.isLoggedIn)throw Error("User Not Logged In");let windowId=getWindowId();communicationProvider._handleWindow(windowId,{target:"_blank",features:getPopupFeatures(FEATURES_CONFIRM_WINDOW)}),_payload.windowId=windowId}inPageProvider._rpcEngine.handle(_payload,cb)},communicationProvider.tryWindowHandle=(payload,cb)=>{let _payload=payload;if(!Array.isArray(_payload)&&COMMUNICATION_UNSAFE_METHODS.includes(_payload.method)){let windowId=getWindowId();communicationProvider._handleWindow(windowId,{target:"_blank",features:getPopupFeatures(FEATURES_PROVIDER_CHANGE_WINDOW)}),_payload.params.windowId=windowId}communicationProvider._rpcEngine.handle(_payload,cb)};let detectAccountRequestPrototypeModifier=m=>{let originalMethod=inPageProvider[m],self1=this;inPageProvider[m]=function(request,cb){let{method,params=[]}=request;if("solana_requestAccounts"===method){if(!cb)return self1.login({loginProvider:params[0]});self1.login({loginProvider:params[0]}).then(res=>cb(null,res)).catch(err=>cb(err))}return originalMethod.apply(this,[request,cb])}};detectAccountRequestPrototypeModifier("request"),detectAccountRequestPrototypeModifier("sendAsync"),detectAccountRequestPrototypeModifier("send");let proxiedInPageProvider=new Proxy(inPageProvider,{deleteProperty:()=>!0}),proxiedCommunicationProvider=new Proxy(communicationProvider,{deleteProperty:()=>!0});this.provider=proxiedInPageProvider,this.communicationProvider=proxiedCommunicationProvider,await Promise.all([inPageProvider._initializeState(),communicationProvider._initializeState(_objectSpread(_objectSpread({},providerParams),{},{dappStorageKey:this.dappStorageKey,torusAlertContainer:this.torusAlertContainer,torusIframe:this.torusIframe}))]),log.debug("Torus - injected provider")}}var base_esm=__webpack_require__(45624),baseSolanaAdapter_esm=__webpack_require__(1482),solanaProvider_esm=__webpack_require__(44445);function torusSolanaAdapter_esm_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function torusSolanaAdapter_esm_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?torusSolanaAdapter_esm_ownKeys(Object(source),!0).forEach(function(key){(0,defineProperty.Z)(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):torusSolanaAdapter_esm_ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}class SolanaWalletAdapter extends baseSolanaAdapter_esm.v{constructor(){let params=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),(0,defineProperty.Z)(this,"name",base_esm.rW.TORUS_SOLANA),(0,defineProperty.Z)(this,"adapterNamespace",base_esm.yk.SOLANA),(0,defineProperty.Z)(this,"currentChainNamespace",base_esm.EN.SOLANA),(0,defineProperty.Z)(this,"type",base_esm.hN.EXTERNAL),(0,defineProperty.Z)(this,"status",base_esm.MP.NOT_READY),(0,defineProperty.Z)(this,"torusInstance",null),(0,defineProperty.Z)(this,"torusWalletOptions",void 0),(0,defineProperty.Z)(this,"initParams",void 0),(0,defineProperty.Z)(this,"loginSettings",{}),(0,defineProperty.Z)(this,"solanaProvider",null),(0,defineProperty.Z)(this,"rehydrated",!1),this.torusWalletOptions=params.adapterSettings||{},this.initParams=params.initParams||{},this.loginSettings=params.loginSettings||{},this.chainConfig=params.chainConfig||null,this.sessionTime=params.sessionTime||86400}get provider(){if(this.status===base_esm.MP.CONNECTED&&this.solanaProvider){var _this$solanaProvider;return(null===(_this$solanaProvider=this.solanaProvider)||void 0===_this$solanaProvider?void 0:_this$solanaProvider.provider)||null}return null}set provider(_){throw Error("Not implemented")}async init(options){let network;if(super.checkInitializationRequirements(),this.chainConfig){let{chainId,blockExplorer,displayName,rpcTarget,ticker,tickerName}=this.chainConfig;network={chainId,rpcTarget,blockExplorerUrl:blockExplorer,displayName,tickerName,ticker,logo:""}}else{this.chainConfig=(0,base_esm.h2)(base_esm.EN.SOLANA,"0x1");let{blockExplorer:blockExplorer1,displayName:displayName1,ticker:ticker1,tickerName:tickerName1,rpcTarget:rpcTarget1,chainId:chainId1}=this.chainConfig;network={chainId:chainId1,rpcTarget:rpcTarget1,blockExplorerUrl:blockExplorer1,displayName:displayName1,ticker:ticker1,tickerName:tickerName1,logo:""}}this.torusInstance=new Torus(this.torusWalletOptions),base_esm.cM.debug("initializing torus solana adapter init"),await this.torusInstance.init(torusSolanaAdapter_esm_objectSpread(torusSolanaAdapter_esm_objectSpread({showTorusButton:!1},this.initParams),{},{network})),this.solanaProvider=new solanaProvider_esm.TorusInjectedProvider({config:{chainConfig:this.chainConfig}}),this.status=base_esm.MP.READY,this.emit(base_esm.n2.READY,base_esm.rW.TORUS_SOLANA);try{base_esm.cM.debug("initializing torus solana adapter"),options.autoConnect&&(this.rehydrated=!0,await this.connect())}catch(error){base_esm.cM.error("Failed to connect with cached torus solana provider",error),this.emit(base_esm.n2.ERRORED,error)}}async connect(){if(super.checkConnectionRequirements(),!this.torusInstance||!this.solanaProvider)throw base_esm.Ty.notReady("Torus wallet is not initialized");this.status=base_esm.MP.CONNECTING,this.emit(base_esm.n2.CONNECTING,{adapter:base_esm.rW.TORUS_SOLANA});try{await this.torusInstance.login(this.loginSettings);try{let torusInpageProvider=this.torusInstance.provider;torusInpageProvider.sendTransaction=this.torusInstance.sendTransaction.bind(this.torusInstance),torusInpageProvider.signAllTransactions=this.torusInstance.signAllTransactions.bind(this.torusInstance),torusInpageProvider.signMessage=this.torusInstance.signMessage.bind(this.torusInstance),torusInpageProvider.signTransaction=this.torusInstance.signTransaction.bind(this.torusInstance),await this.solanaProvider.setupProvider(torusInpageProvider)}catch(error){if(error instanceof base_esm.up&&5010===error.code){let{chainId,blockExplorer,displayName,rpcTarget,ticker,tickerName}=this.chainConfig;await this.torusInstance.setProvider({chainId,rpcTarget,blockExplorerUrl:blockExplorer,displayName,tickerName,ticker,logo:""})}else throw error}return this.status=base_esm.MP.CONNECTED,this.torusInstance.showTorusButton(),this.emit(base_esm.MP.CONNECTED,{adapter:base_esm.rW.TORUS_SOLANA,reconnected:this.rehydrated}),this.provider}catch(error1){throw this.status=base_esm.MP.READY,this.rehydrated=!1,this.emit(base_esm.n2.ERRORED,error1),base_esm.RM.connectionError("Failed to login with torus solana wallet")}}async disconnect(){let options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{cleanup:!1};if(!this.torusInstance)throw base_esm.Ty.notReady("Torus wallet is not initialized");await super.disconnect(),await this.torusInstance.logout(),options.cleanup?(this.status=base_esm.MP.NOT_READY,this.torusInstance=null,this.solanaProvider=null):this.status=base_esm.MP.READY,this.emit(base_esm.n2.DISCONNECTED)}async getUserInfo(){if(this.status!==base_esm.MP.CONNECTED)throw base_esm.RM.notConnectedError("Not connected with wallet");if(!this.torusInstance)throw base_esm.Ty.notReady("Torus wallet is not initialized");let userInfo=await this.torusInstance.getUserInfo();return userInfo}setAdapterSettings(options){this.status!==base_esm.MP.READY&&null!=options&&options.sessionTime&&(this.sessionTime=options.sessionTime)}}},58162:function(module){"use strict";module.exports=function(ALPHABET){if(ALPHABET.length>=255)throw TypeError("Alphabet too long");for(var BASE_MAP=new Uint8Array(256),j=0;j<BASE_MAP.length;j++)BASE_MAP[j]=255;for(var i=0;i<ALPHABET.length;i++){var x=ALPHABET.charAt(i),xc=x.charCodeAt(0);if(255!==BASE_MAP[xc])throw TypeError(x+" is ambiguous");BASE_MAP[xc]=i}var BASE=ALPHABET.length,LEADER=ALPHABET.charAt(0),FACTOR=Math.log(BASE)/Math.log(256),iFACTOR=Math.log(256)/Math.log(BASE);function decodeUnsafe(source){if("string"!=typeof source)throw TypeError("Expected String");if(0===source.length)return new Uint8Array;for(var psz=0,zeroes=0,length=0;source[psz]===LEADER;)zeroes++,psz++;for(var size=(source.length-psz)*FACTOR+1>>>0,b256=new Uint8Array(size);source[psz];){var carry=BASE_MAP[source.charCodeAt(psz)];if(255===carry)return;for(var i=0,it3=size-1;(0!==carry||i<length)&&-1!==it3;it3--,i++)carry+=BASE*b256[it3]>>>0,b256[it3]=carry%256>>>0,carry=carry/256>>>0;if(0!==carry)throw Error("Non-zero carry");length=i,psz++}for(var it4=size-length;it4!==size&&0===b256[it4];)it4++;for(var vch=new Uint8Array(zeroes+(size-it4)),j=zeroes;it4!==size;)vch[j++]=b256[it4++];return vch}return{encode:function(source){if(source instanceof Uint8Array||(ArrayBuffer.isView(source)?source=new Uint8Array(source.buffer,source.byteOffset,source.byteLength):Array.isArray(source)&&(source=Uint8Array.from(source))),!(source instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===source.length)return"";for(var zeroes=0,length=0,pbegin=0,pend=source.length;pbegin!==pend&&0===source[pbegin];)pbegin++,zeroes++;for(var size=(pend-pbegin)*iFACTOR+1>>>0,b58=new Uint8Array(size);pbegin!==pend;){for(var carry=source[pbegin],i=0,it1=size-1;(0!==carry||i<length)&&-1!==it1;it1--,i++)carry+=256*b58[it1]>>>0,b58[it1]=carry%BASE>>>0,carry=carry/BASE>>>0;if(0!==carry)throw Error("Non-zero carry");length=i,pbegin++}for(var it2=size-length;it2!==size&&0===b58[it2];)it2++;for(var str=LEADER.repeat(zeroes);it2<size;++it2)str+=ALPHABET.charAt(b58[it2]);return str},decodeUnsafe:decodeUnsafe,decode:function(string){var buffer=decodeUnsafe(string);if(buffer)return buffer;throw Error("Non-base"+BASE+" character")}}}},77191:function(module,__unused_webpack_exports,__webpack_require__){let basex=__webpack_require__(58162);module.exports=basex("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},64063:function(module){"use strict";module.exports=function equal(a,b){if(a===b)return!0;if(a&&b&&"object"==typeof a&&"object"==typeof b){if(a.constructor!==b.constructor)return!1;if(Array.isArray(a)){if((length=a.length)!=b.length)return!1;for(i=length;0!=i--;)if(!equal(a[i],b[i]))return!1;return!0}if(a.constructor===RegExp)return a.source===b.source&&a.flags===b.flags;if(a.valueOf!==Object.prototype.valueOf)return a.valueOf()===b.valueOf();if(a.toString!==Object.prototype.toString)return a.toString()===b.toString();if((length=(keys=Object.keys(a)).length)!==Object.keys(b).length)return!1;for(i=length;0!=i--;)if(!Object.prototype.hasOwnProperty.call(b,keys[i]))return!1;for(i=length;0!=i--;){var length,i,keys,key=keys[i];if(!equal(a[key],b[key]))return!1}return!0}return a!=a&&b!=b}},24970:function(module){"use strict";let isStream=stream=>null!==stream&&"object"==typeof stream&&"function"==typeof stream.pipe;isStream.writable=stream=>isStream(stream)&&!1!==stream.writable&&"function"==typeof stream._write&&"object"==typeof stream._writableState,isStream.readable=stream=>isStream(stream)&&!1!==stream.readable&&"function"==typeof stream._read&&"object"==typeof stream._readableState,isStream.duplex=stream=>isStream.writable(stream)&&isStream.readable(stream),isStream.transform=stream=>isStream.duplex(stream)&&"function"==typeof stream._transform,module.exports=isStream},27384:function(module){"use strict";module.exports=JSON.parse('{"name":"@toruslabs/solana-embed","version":"0.2.2","description":"Embed script for solana blockchain","main":"dist/solanaEmbed.cjs.js","module":"dist/solanaEmbed.esm.js","unpkg":"dist/solanaEmbed.umd.min.js","jsdelivr":"dist/solanaEmbed.umd.min.js","types":"dist/types/index.d.ts","files":["dist","src"],"scripts":{"start":"torus-scripts start","build":"torus-scripts build","build:test":"cross-env NODE_ENV=testing torus-scripts build","release":"torus-scripts release","prepack":"npm run build","lint:ts":"eslint --fix \'src/**/*.ts\'","prepare":"husky install"},"repository":{"type":"git","url":"git+https://github.com/torusresearch/solana-embed.git"},"dependencies":{"@solana/web3.js":"^1.36.0","@toruslabs/base-controllers":"^2.0.0","@toruslabs/http-helpers":"^3.0.0","@toruslabs/openlogin-jrpc":"^2.0.0","eth-rpc-errors":"^4.0.3","fast-deep-equal":"^3.1.3","is-stream":"^2.0.0","lodash-es":"^4.17.21","loglevel":"^1.8.0","pump":"^3.0.0"},"peerDependencies":{"@babel/runtime":"7.x"},"devDependencies":{"@babel/register":"^7.17.7","@commitlint/cli":"^16.2.1","@commitlint/config-conventional":"^16.2.1","@commitlint/is-ignored":"^16.2.1","@toruslabs/eslint-config-typescript":"^1.0.1","@toruslabs/torus-scripts":"^1.0.3","@babel/runtime":"^7.18.0","@types/bs58":"^4.0.1","@types/node":"^17.0.35","@types/once":"^1.4.0","@types/pump":"^1.1.1","@types/readable-stream":"^2.3.13","@typescript-eslint/eslint-plugin":"^5.25.0","@typescript-eslint/parser":"^5.25.0","cross-env":"^7.0.3","eslint":"^8.15.0","eslint-plugin-import":"^2.26.0","eslint-plugin-mocha":"^10.0.4","eslint-plugin-n":"^15.2.0","eslint-plugin-prettier":"^4.0.0","eslint-plugin-promise":"^6.0.0","eslint-plugin-simple-import-sort":"^7.0.0","eslint-plugin-tsdoc":"^0.2.16","husky":"^8.0.1","lint-staged":"^12.4.1","mocha":"^10.0.0","prettier":"^2.6.2","puppeteer":"^14.1.1","rimraf":"^3.0.2","ts-node":"^10.7.0","typescript":"^4.6.4"},"mocha":{"timeout":0},"keywords":["torus","wallet","Solana","embed","login","OAuth","crypto"],"author":"Torus Labs","license":"ISC","bugs":{"url":"https://github.com/torusresearch/solana-embed/issues"},"homepage":"https://github.com/torusresearch/solana-embed#readme","lint-staged":{"!(*d).{js,ts}":["eslint --cache --fix","prettier --write"],"*.{json, md}":["prettier --write"]},"engines":{"node":">=14.17.0","npm":">=6.x"}}')}}]);